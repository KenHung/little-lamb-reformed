<script src="https://unpkg.com/vue@3"></script>
<script>
  var PixnetComments = {
    data() {
      return {
        article_id: '{{ page.id }}'.split('/').pop(),
        comments: []
      }
    },
    methods: {
      getComments(page) {
        var vm = this;
        var xhr = new XMLHttpRequest();
        var url = 'https://emma.pixnet.cc/blog/articles/' + article_id + '/comments?user=mickey1124&page=' + page;
        xhr.open('GET', url);
        xhr.onload = function () {
          if (xhr.status === 200) {
            var resp = JSON.parse(xhr.responseText);
            console.log(resp.message);
            vm.comments = resp.comments;
          }
        }
        // TODO: add error handling
        xhr.send();
      }
    }
  };
  var vm = Vue.createApp(PixnetComments).mount('#pixnet-comments');
  vm.getComments(1);
</script>