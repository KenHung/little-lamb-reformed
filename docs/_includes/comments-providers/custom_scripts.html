<script src="https://unpkg.com/vue@3"></script>
<script>
  var PixnetComments = {
    data() {
      return {
        articleId: '{{ page.id }}'.split('/').pop(),
        currentPage: 1,
        totalPages: [1, 2, 3, 4, 5],
        comments: [],
        labelPrevious: '{{ site.data.ui-text[site.locale].pagination_previous }}',
        labelNext: '{{ site.data.ui-text[site.locale].pagination_next }}'
      }
    },
    methods: {
      getComments() {
        var vm = this;
        var xhr = new XMLHttpRequest();
        var url = 'https://emma.pixnet.cc/blog/articles/' + this.articleId + '/comments'
          + '?user=mickey1124&page=' + this.currentPage;
        xhr.open('GET', url);
        xhr.onload = function () {
          if (xhr.status === 200) {
            var resp = JSON.parse(xhr.responseText);
            console.log(resp.message);
            vm.comments = resp.comments;
          }
        }
        // TODO: add error handling
        xhr.send();
      }
    }
  };
  var vm = Vue.createApp(PixnetComments).mount('#pixnet-comments');
  vm.getComments();
</script>